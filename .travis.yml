sudo: required
language: python
python:
  - "3.6"
services:
  - docker

install:
  - pip install -r requirements.txt

script:
  - pytest
  - npm install -g snyk
#  - snyk test
  - docker build -t sierra-nginx . --no-cache=True
  - docker run -p 127.0.0.1:80:5000 -d -t sierra-nginx
  - docker ps -a

after_success:
#  - snyk monitor
  - radon cc sierra*.py -as
  - curl -v 127.0.0.1:80

deploy:
  - docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD

